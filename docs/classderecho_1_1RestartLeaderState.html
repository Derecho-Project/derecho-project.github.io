<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Derecho: derecho::RestartLeaderState Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Derecho
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Distributed systems toolkit for RDMA</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacederecho.html">derecho</a></li><li class="navelem"><a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classderecho_1_1RestartLeaderState-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">derecho::RestartLeaderState Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="restart__state_8h_source.html">restart_state.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for derecho::RestartLeaderState:</div>
<div class="dyncontent">
<div class="center"><img src="classderecho_1_1RestartLeaderState__coll__graph.png" border="0" usemap="#derecho_1_1RestartLeaderState_coll__map" alt="Collaboration graph"/></div>
<map name="derecho_1_1RestartLeaderState_coll__map" id="derecho_1_1RestartLeaderState_coll__map">
<area shape="rect" id="node3" href="classtcp_1_1socket.html" title="tcp::socket" alt="" coords="1960,16,2047,43"/>
<area shape="rect" id="node4" title="STL class. " alt="" coords="1579,16,1659,43"/>
<area shape="rect" id="node5" title="STL class. " alt="" coords="1224,9,1351,50"/>
<area shape="rect" id="node7" href="classderecho_1_1View.html" title="derecho::View" alt="" coords="1951,335,2056,361"/>
<area shape="rect" id="node20" href="namespacederecho.html#structderecho_1_1SubgroupSettings" title="A collection of settings for a single subgroup that this node is a member of. " alt="" coords="283,253,462,280"/>
<area shape="rect" id="node18" href="classderecho_1_1MulticastGroup.html" title="Implements the low&#45;level mechanics of tracking multicasts in a Derecho group, using RDMC to deliver m..." alt="" coords="1205,820,1369,847"/>
<area shape="rect" id="node25" href="namespacederecho.html#structderecho_1_1RDMCMessage" title="A structure containing an RDMC message (which consists of some bytes in a registered memory region) a..." alt="" coords="5,979,176,1005"/>
<area shape="rect" id="node27" href="namespacederecho.html#structderecho_1_1CallbackSet" title="Bundles together a set of callback functions for message delivery events. " alt="" coords="783,865,930,892"/>
<area shape="rect" id="node38" title="STL class. " alt="" coords="815,393,899,420"/>
<area shape="rect" id="node46" href="structderecho_1_1RestartState.html" title="derecho::RestartState" alt="" coords="2273,393,2423,420"/>
<area shape="rect" id="node47" href="structderecho_1_1SubgroupInfo.html" title="Container for whatever information is needed to describe a Group&#39;s subgroups and shards. " alt="" coords="2271,444,2425,471"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a45fa9b3f4aa5c831f676ee434a7c22d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a45fa9b3f4aa5c831f676ee434a7c22d9">RestartLeaderState</a> (std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt; _curr_view, <a class="el" href="structderecho_1_1RestartState.html">RestartState</a> &amp;<a class="el" href="classderecho_1_1RestartLeaderState.html#ad10db7a56c51a3c2f1d745e27287d0d4">restart_state</a>, std::map&lt; <a class="el" href="namespacederecho.html#a5166c1baf8aaf072658901fa0ec4e06d">subgroup_id_t</a>, <a class="el" href="namespacederecho.html#structderecho_1_1SubgroupSettings">SubgroupSettings</a> &gt; &amp;subgroup_settings_map, uint32_t &amp;num_received_size, const <a class="el" href="structderecho_1_1SubgroupInfo.html">SubgroupInfo</a> &amp;<a class="el" href="classderecho_1_1RestartLeaderState.html#a59e1b8011434a6864d1097800799a44d">subgroup_info</a>, const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> <a class="el" href="classderecho_1_1RestartLeaderState.html#a177bae7ac9e5e4929e524ada854ea057">my_id</a>)</td></tr>
<tr class="separator:a45fa9b3f4aa5c831f676ee434a7c22d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac04e52d1f451b1fad75672ca3ea6012f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ac04e52d1f451b1fad75672ca3ea6012f">await_quorum</a> (<a class="el" href="classtcp_1_1connection__listener.html">tcp::connection_listener</a> &amp;server_socket)</td></tr>
<tr class="memdesc:ac04e52d1f451b1fad75672ca3ea6012f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for nodes to rejoin at this node, updating the last known <a class="el" href="classderecho_1_1View.html">View</a> and <a class="el" href="structderecho_1_1RaggedTrim.html" title="Represents the data needed to log a &quot;ragged trim&quot; decision to disk. ">RaggedTrim</a> (and corresponding longest-log information) as each node connects, until there is a quorum of nodes from the last known <a class="el" href="classderecho_1_1View.html">View</a> and a new <a class="el" href="classderecho_1_1View.html">View</a> can be installed that is adequately provisioned.  <a href="#ac04e52d1f451b1fad75672ca3ea6012f">More...</a><br /></td></tr>
<tr class="separator:ac04e52d1f451b1fad75672ca3ea6012f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ec16abd727079dd452c33fe75abf39"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#aa0ec16abd727079dd452c33fe75abf39">compute_restart_view</a> ()</td></tr>
<tr class="memdesc:aa0ec16abd727079dd452c33fe75abf39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recomputes the restart view based on the current set of nodes that have rejoined (in waiting_join_sockets and rejoined_node_ids).  <a href="#aa0ec16abd727079dd452c33fe75abf39">More...</a><br /></td></tr>
<tr class="separator:aa0ec16abd727079dd452c33fe75abf39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10f333d6ec3f6e71cbfcf7cd4f50248"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ab10f333d6ec3f6e71cbfcf7cd4f50248">send_restart_view</a> (const <a class="el" href="structderecho_1_1DerechoParams.html">DerechoParams</a> &amp;derecho_params)</td></tr>
<tr class="memdesc:ab10f333d6ec3f6e71cbfcf7cd4f50248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the currently-computed restart view and the provided <a class="el" href="structderecho_1_1DerechoParams.html" title="Bundles together a set of low-level parameters for configuring Derecho groups. ">DerechoParams</a> to all members who are currently ready to restart.  <a href="#ab10f333d6ec3f6e71cbfcf7cd4f50248">More...</a><br /></td></tr>
<tr class="separator:ab10f333d6ec3f6e71cbfcf7cd4f50248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76a560aa72b60eb6b3fcf6a12534acbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a76a560aa72b60eb6b3fcf6a12534acbc">confirm_restart_view</a> (const bool commit)</td></tr>
<tr class="memdesc:a76a560aa72b60eb6b3fcf6a12534acbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a Boolean value to all nodes that have previously been sent the restart view, indicating whether they can commit this view or must discard it because some node has failed.  <a href="#a76a560aa72b60eb6b3fcf6a12534acbc">More...</a><br /></td></tr>
<tr class="separator:a76a560aa72b60eb6b3fcf6a12534acbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e69984413dfc1c4647d06976da003e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a9e69984413dfc1c4647d06976da003e3">send_shard_leaders</a> ()</td></tr>
<tr class="memdesc:a9e69984413dfc1c4647d06976da003e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the list of nodes from each shard that have the longest log (which are the restart shard leaders, though they won't be shard leaders after restart) to all members in the restart view, then closes their TCP sockets.  <a href="#a9e69984413dfc1c4647d06976da003e3">More...</a><br /></td></tr>
<tr class="separator:a9e69984413dfc1c4647d06976da003e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406db927852f7c41c8afef1b185595c2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classderecho_1_1View.html">View</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a406db927852f7c41c8afef1b185595c2">get_curr_view</a> () const </td></tr>
<tr class="memdesc:a406db927852f7c41c8afef1b185595c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the curr_view (last known view) managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>.  <a href="#a406db927852f7c41c8afef1b185595c2">More...</a><br /></td></tr>
<tr class="separator:a406db927852f7c41c8afef1b185595c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8334be3873cd3368497e9a78a1b5d15"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classderecho_1_1View.html">View</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ac8334be3873cd3368497e9a78a1b5d15">get_restart_view</a> () const </td></tr>
<tr class="memdesc:ac8334be3873cd3368497e9a78a1b5d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the current restart view managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>.  <a href="#ac8334be3873cd3368497e9a78a1b5d15">More...</a><br /></td></tr>
<tr class="separator:ac8334be3873cd3368497e9a78a1b5d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ad6706b32db3a104b58ca842d9601f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a24ad6706b32db3a104b58ca842d9601f">take_restart_view</a> ()</td></tr>
<tr class="memdesc:a24ad6706b32db3a104b58ca842d9601f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove and return the restart view managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>; this will take ownership back to the caller (<a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>).  <a href="#a24ad6706b32db3a104b58ca842d9601f">More...</a><br /></td></tr>
<tr class="separator:a24ad6706b32db3a104b58ca842d9601f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a793954aaa590b78684120d10c64837"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a3a793954aaa590b78684120d10c64837">print_longest_logs</a> () const </td></tr>
<tr class="separator:a3a793954aaa590b78684120d10c64837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae55cf282a24dd0bb6ed2b54a1e524691"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ae55cf282a24dd0bb6ed2b54a1e524691">update_curr_and_next_restart_view</a> ()</td></tr>
<tr class="memdesc:ae55cf282a24dd0bb6ed2b54a1e524691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates curr_view and makes a new next_view based on the current set of rejoining nodes during total restart.  <a href="#ae55cf282a24dd0bb6ed2b54a1e524691">More...</a><br /></td></tr>
<tr class="separator:ae55cf282a24dd0bb6ed2b54a1e524691"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab636f1872684e166fd8cfbd014efc4a4"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ab636f1872684e166fd8cfbd014efc4a4">make_next_view</a> (const std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt; &amp;<a class="el" href="classderecho_1_1RestartLeaderState.html#af3d6a3ec2ff26b518e40a08244914430">curr_view</a>, const std::vector&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt; &amp;joiner_ids, const std::vector&lt; std::tuple&lt; <a class="el" href="derecho__type__definitions_8h.html#ab11e09092fcdbb0202a500479b3939b4">ip_addr_t</a>, uint16_t, uint16_t, uint16_t, uint16_t &gt;&gt; &amp;joiner_ips_and_ports <a class="el" href="classderecho_1_1RestartLeaderState.html#a5c4dac12cac21410c133e27961fb85d0">whenlog</a>(, std::shared_ptr&lt; spdlog::logger &gt; logger))</td></tr>
<tr class="memdesc:ab636f1872684e166fd8cfbd014efc4a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs the next view from the current view and a list of joining nodes, by ID and IP address.  <a href="#ab636f1872684e166fd8cfbd014efc4a4">More...</a><br /></td></tr>
<tr class="separator:ab636f1872684e166fd8cfbd014efc4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe472e1ac35dce6bcf308f3071a410f8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#afe472e1ac35dce6bcf308f3071a410f8">contains_at_least_one_member_per_subgroup</a> (std::set&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt; <a class="el" href="classderecho_1_1RestartLeaderState.html#a0e55150853a3b72f96ec5f4dd450eb63">rejoined_node_ids</a>, const <a class="el" href="classderecho_1_1View.html">View</a> &amp;last_view)</td></tr>
<tr class="separator:afe472e1ac35dce6bcf308f3071a410f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a006f091dab3c44f804848a1002ff36ad"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a006f091dab3c44f804848a1002ff36ad">RESTART_LEADER_TIMEOUT</a> = 300000</td></tr>
<tr class="separator:a006f091dab3c44f804848a1002ff36ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5c4dac12cac21410c133e27961fb85d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a5c4dac12cac21410c133e27961fb85d0">whenlog</a> (std::shared_ptr&lt; spdlog::logger &gt; logger;)</td></tr>
<tr class="separator:a5c4dac12cac21410c133e27961fb85d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac486dc0885a0978eb148de595eee1d3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ac486dc0885a0978eb148de595eee1d3f">receive_joiner_logs</a> (const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &amp;joiner_id, <a class="el" href="classtcp_1_1socket.html">tcp::socket</a> &amp;client_socket)</td></tr>
<tr class="memdesc:ac486dc0885a0978eb148de595eee1d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method for await_quorum that processes the logged <a class="el" href="classderecho_1_1View.html">View</a> and RaggedTrims from a single rejoining node.  <a href="#ac486dc0885a0978eb148de595eee1d3f">More...</a><br /></td></tr>
<tr class="separator:ac486dc0885a0978eb148de595eee1d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af3d6a3ec2ff26b518e40a08244914430"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#af3d6a3ec2ff26b518e40a08244914430">curr_view</a></td></tr>
<tr class="memdesc:af3d6a3ec2ff26b518e40a08244914430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes ownership of <a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>'s curr_view pointer, because await_quroum() might replace curr_view with a newer view discovered on a restarting node.  <a href="#af3d6a3ec2ff26b518e40a08244914430">More...</a><br /></td></tr>
<tr class="separator:af3d6a3ec2ff26b518e40a08244914430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad10db7a56c51a3c2f1d745e27287d0d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structderecho_1_1RestartState.html">RestartState</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#ad10db7a56c51a3c2f1d745e27287d0d4">restart_state</a></td></tr>
<tr class="memdesc:ad10db7a56c51a3c2f1d745e27287d0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutable reference to <a class="el" href="structderecho_1_1RestartState.html">RestartState</a>, since this class needs to update the restart state stored in <a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>.  <a href="#ad10db7a56c51a3c2f1d745e27287d0d4">More...</a><br /></td></tr>
<tr class="separator:ad10db7a56c51a3c2f1d745e27287d0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68a3161093e57a2514d47a2b840556a8"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="namespacederecho.html#a5166c1baf8aaf072658901fa0ec4e06d">subgroup_id_t</a>, <a class="el" href="namespacederecho.html#structderecho_1_1SubgroupSettings">SubgroupSettings</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a68a3161093e57a2514d47a2b840556a8">restart_subgroup_settings</a></td></tr>
<tr class="separator:a68a3161093e57a2514d47a2b840556a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ccdca6b6d5deb4d0e6984d1d194056"><td class="memItemLeft" align="right" valign="top">uint32_t &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a81ccdca6b6d5deb4d0e6984d1d194056">restart_num_received_size</a></td></tr>
<tr class="separator:a81ccdca6b6d5deb4d0e6984d1d194056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e1b8011434a6864d1097800799a44d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structderecho_1_1SubgroupInfo.html">SubgroupInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a59e1b8011434a6864d1097800799a44d">subgroup_info</a></td></tr>
<tr class="separator:a59e1b8011434a6864d1097800799a44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb5a81627ba469372f970dd19deb586"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a8fb5a81627ba469372f970dd19deb586">restart_view</a></td></tr>
<tr class="separator:a8fb5a81627ba469372f970dd19deb586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aef2d498fc4cd8b8eef285db8a1b7fa"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>, <a class="el" href="classtcp_1_1socket.html">tcp::socket</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a4aef2d498fc4cd8b8eef285db8a1b7fa">waiting_join_sockets</a></td></tr>
<tr class="separator:a4aef2d498fc4cd8b8eef285db8a1b7fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fc92d5062bceb5ca930d8cab1ecebb"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>, std::tuple&lt; <a class="el" href="derecho__type__definitions_8h.html#ab11e09092fcdbb0202a500479b3939b4">ip_addr_t</a>, uint16_t, uint16_t, uint16_t, uint16_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a79fc92d5062bceb5ca930d8cab1ecebb">rejoined_node_ips_and_ports</a></td></tr>
<tr class="separator:a79fc92d5062bceb5ca930d8cab1ecebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a855340f27f56c1484e5f67193d7d24ea"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a855340f27f56c1484e5f67193d7d24ea">members_sent_restart_view</a></td></tr>
<tr class="separator:a855340f27f56c1484e5f67193d7d24ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e55150853a3b72f96ec5f4dd450eb63"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a0e55150853a3b72f96ec5f4dd450eb63">rejoined_node_ids</a></td></tr>
<tr class="separator:a0e55150853a3b72f96ec5f4dd450eb63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b5ee977309f0a3bb6511fb283660489"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a8b5ee977309f0a3bb6511fb283660489">last_known_view_members</a></td></tr>
<tr class="separator:a8b5ee977309f0a3bb6511fb283660489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a786d695f407ce24448fa0a4b0b28daa4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; persistent::version_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a786d695f407ce24448fa0a4b0b28daa4">longest_log_versions</a></td></tr>
<tr class="separator:a786d695f407ce24448fa0a4b0b28daa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbeaf385b3693921ba7998d4d076d7fe"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int64_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#adbeaf385b3693921ba7998d4d076d7fe">nodes_with_longest_log</a></td></tr>
<tr class="separator:adbeaf385b3693921ba7998d4d076d7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a177bae7ac9e5e4929e524ada854ea057"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classderecho_1_1RestartLeaderState.html#a177bae7ac9e5e4929e524ada854ea057">my_id</a></td></tr>
<tr class="separator:a177bae7ac9e5e4929e524ada854ea057"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00070">70</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a45fa9b3f4aa5c831f676ee434a7c22d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">derecho::RestartLeaderState::RestartLeaderState </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt;&#160;</td>
          <td class="paramname"><em>_curr_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structderecho_1_1RestartState.html">RestartState</a> &amp;&#160;</td>
          <td class="paramname"><em>restart_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; <a class="el" href="namespacederecho.html#a5166c1baf8aaf072658901fa0ec4e06d">subgroup_id_t</a>, <a class="el" href="namespacederecho.html#structderecho_1_1SubgroupSettings">SubgroupSettings</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>subgroup_settings_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>num_received_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structderecho_1_1SubgroupInfo.html">SubgroupInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>subgroup_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>&#160;</td>
          <td class="paramname"><em>my_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00073">73</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac04e52d1f451b1fad75672ca3ea6012f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void derecho::RestartLeaderState::await_quorum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtcp_1_1connection__listener.html">tcp::connection_listener</a> &amp;&#160;</td>
          <td class="paramname"><em>server_socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for nodes to rejoin at this node, updating the last known <a class="el" href="classderecho_1_1View.html">View</a> and <a class="el" href="structderecho_1_1RaggedTrim.html" title="Represents the data needed to log a &quot;ragged trim&quot; decision to disk. ">RaggedTrim</a> (and corresponding longest-log information) as each node connects, until there is a quorum of nodes from the last known <a class="el" href="classderecho_1_1View.html">View</a> and a new <a class="el" href="classderecho_1_1View.html">View</a> can be installed that is adequately provisioned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server_socket</td><td>The TCP socket to listen for rejoining nodes on </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00106">106</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa0ec16abd727079dd452c33fe75abf39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool derecho::RestartLeaderState::compute_restart_view </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recomputes the restart view based on the current set of nodes that have rejoined (in waiting_join_sockets and rejoined_node_ids). </p>
<dl class="section return"><dt>Returns</dt><dd>True if the group is now ready to restart, false if it is not (because, e.g. the restart view would be inadequate). </dd></dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00230">230</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a76a560aa72b60eb6b3fcf6a12534acbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void derecho::RestartLeaderState::confirm_restart_view </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>commit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a Boolean value to all nodes that have previously been sent the restart view, indicating whether they can commit this view or must discard it because some node has failed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">commit</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00329">329</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afe472e1ac35dce6bcf308f3071a410f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool derecho::RestartLeaderState::contains_at_least_one_member_per_subgroup </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt;&#160;</td>
          <td class="paramname"><em>rejoined_node_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classderecho_1_1View.html">View</a> &amp;&#160;</td>
          <td class="paramname"><em>last_view</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the set of node IDs includes at least one member of each subgroup in the given <a class="el" href="classderecho_1_1View.html">View</a>. </dd></dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00442">442</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a406db927852f7c41c8afef1b185595c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classderecho_1_1View.html">View</a>&amp; derecho::RestartLeaderState::get_curr_view </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the curr_view (last known view) managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>. </p>
<p>Only used for debugging. </p>

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00147">147</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac8334be3873cd3368497e9a78a1b5d15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classderecho_1_1View.html">View</a>&amp; derecho::RestartLeaderState::get_restart_view </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the current restart view managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>. </p>

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00149">149</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab636f1872684e166fd8cfbd014efc4a4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt; derecho::RestartLeaderState::make_next_view </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>curr_view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>joiner_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::tuple&lt; <a class="el" href="derecho__type__definitions_8h.html#ab11e09092fcdbb0202a500479b3939b4">ip_addr_t</a>, uint16_t, uint16_t, uint16_t, uint16_t &gt;&gt; &amp;joiner_ips_and_ports &#160;</td>
          <td class="paramname"><em>whenlog</em>, std::shared_ptr&lt; spdlog::logger &gt; logger&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs the next view from the current view and a list of joining nodes, by ID and IP address. </p>
<p>This version is only used by the restart leader during total restart, and assumes that all nodes marked failed in curr_view will be removed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">curr_view</td><td>The current view, including the list of failed members to remove </td></tr>
    <tr><td class="paramname">joiner_ids</td><td></td></tr>
    <tr><td class="paramname">joiner_ips</td><td></td></tr>
    <tr><td class="paramname">logger</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="classderecho_1_1View.html">View</a> object for the next view </dd></dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00380">380</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3a793954aaa590b78684120d10c64837"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void derecho::RestartLeaderState::print_longest_logs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00339">339</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac486dc0885a0978eb148de595eee1d3f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void derecho::RestartLeaderState::receive_joiner_logs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> &amp;&#160;</td>
          <td class="paramname"><em>joiner_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classtcp_1_1socket.html">tcp::socket</a> &amp;&#160;</td>
          <td class="paramname"><em>client_socket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper method for await_quorum that processes the logged <a class="el" href="classderecho_1_1View.html">View</a> and RaggedTrims from a single rejoining node. </p>
<p>This may update curr_view or logged_ragged_trim if the joiner has newer information. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">joiner_id</td><td>The ID of the rejoining node </td></tr>
    <tr><td class="paramname">client_socket</td><td>The TCP socket connected to the rejoining node </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00158">158</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab10f333d6ec3f6e71cbfcf7cd4f50248"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t derecho::RestartLeaderState::send_restart_view </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structderecho_1_1DerechoParams.html">DerechoParams</a> &amp;&#160;</td>
          <td class="paramname"><em>derecho_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the currently-computed restart view and the provided <a class="el" href="structderecho_1_1DerechoParams.html" title="Bundles together a set of low-level parameters for configuring Derecho groups. ">DerechoParams</a> to all members who are currently ready to restart. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">derecho_params</td><td>The <a class="el" href="structderecho_1_1DerechoParams.html" title="Bundles together a set of low-level parameters for configuring Derecho groups. ">DerechoParams</a> to send to each restarting node </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 if all sends were successful; the ID of a node that has failed if sending the <a class="el" href="classderecho_1_1View.html">View</a> to a node failed. </dd></dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00243">243</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9e69984413dfc1c4647d06976da003e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void derecho::RestartLeaderState::send_shard_leaders </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the list of nodes from each shard that have the longest log (which are the restart shard leaders, though they won't be shard leaders after restart) to all members in the restart view, then closes their TCP sockets. </p>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00312">312</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a24ad6706b32db3a104b58ca842d9601f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classderecho_1_1View.html">View</a>&gt; derecho::RestartLeaderState::take_restart_view </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove and return the restart view managed by <a class="el" href="classderecho_1_1RestartLeaderState.html">RestartLeaderState</a>; this will take ownership back to the caller (<a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>). </p>

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00152">152</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae55cf282a24dd0bb6ed2b54a1e524691"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classderecho_1_1View.html">View</a> &gt; derecho::RestartLeaderState::update_curr_and_next_restart_view </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates curr_view and makes a new next_view based on the current set of rejoining nodes during total restart. </p>
<p>This is only used by the restart leader during total restart. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">waiting_join_sockets</td><td>The set of connections to restarting nodes </td></tr>
    <tr><td class="paramname">rejoined_node_ids</td><td>The IDs of those nodes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The next view that will be installed if the restart continues at this point </dd></dl>

<p>Definition at line <a class="el" href="restart__state_8cpp_source.html#l00351">351</a> of file <a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5c4dac12cac21410c133e27961fb85d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">derecho::RestartLeaderState::whenlog </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; spdlog::logger &gt; logger;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af3d6a3ec2ff26b518e40a08244914430"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classderecho_1_1View.html">View</a>&gt; derecho::RestartLeaderState::curr_view</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Takes ownership of <a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>'s curr_view pointer, because await_quroum() might replace curr_view with a newer view discovered on a restarting node. </p>

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00076">76</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8b5ee977309f0a3bb6511fb283660489"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>&gt; derecho::RestartLeaderState::last_known_view_members</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00089">89</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a786d695f407ce24448fa0a4b0b28daa4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;persistent::version_t&gt; &gt; derecho::RestartLeaderState::longest_log_versions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00090">90</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a855340f27f56c1484e5f67193d7d24ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>&gt; derecho::RestartLeaderState::members_sent_restart_view</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00087">87</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a177bae7ac9e5e4929e524ada854ea057"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a> derecho::RestartLeaderState::my_id</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00092">92</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="adbeaf385b3693921ba7998d4d076d7fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;int64_t&gt; &gt; derecho::RestartLeaderState::nodes_with_longest_log</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00091">91</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0e55150853a3b72f96ec5f4dd450eb63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>&gt; derecho::RestartLeaderState::rejoined_node_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00088">88</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79fc92d5062bceb5ca930d8cab1ecebb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>, std::tuple&lt;<a class="el" href="derecho__type__definitions_8h.html#ab11e09092fcdbb0202a500479b3939b4">ip_addr_t</a>, uint16_t, uint16_t, uint16_t, uint16_t&gt; &gt; derecho::RestartLeaderState::rejoined_node_ips_and_ports</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00086">86</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a006f091dab3c44f804848a1002ff36ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int derecho::RestartLeaderState::RESTART_LEADER_TIMEOUT = 300000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00104">104</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a81ccdca6b6d5deb4d0e6984d1d194056"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t&amp; derecho::RestartLeaderState::restart_num_received_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00081">81</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad10db7a56c51a3c2f1d745e27287d0d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structderecho_1_1RestartState.html">RestartState</a>&amp; derecho::RestartLeaderState::restart_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutable reference to <a class="el" href="structderecho_1_1RestartState.html">RestartState</a>, since this class needs to update the restart state stored in <a class="el" href="classderecho_1_1ViewManager.html">ViewManager</a>. </p>

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00079">79</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a68a3161093e57a2514d47a2b840556a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="namespacederecho.html#a5166c1baf8aaf072658901fa0ec4e06d">subgroup_id_t</a>, <a class="el" href="namespacederecho.html#structderecho_1_1SubgroupSettings">SubgroupSettings</a>&gt;&amp; derecho::RestartLeaderState::restart_subgroup_settings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00080">80</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8fb5a81627ba469372f970dd19deb586"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classderecho_1_1View.html">View</a>&gt; derecho::RestartLeaderState::restart_view</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00084">84</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59e1b8011434a6864d1097800799a44d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structderecho_1_1SubgroupInfo.html">SubgroupInfo</a>&amp; derecho::RestartLeaderState::subgroup_info</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00082">82</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4aef2d498fc4cd8b8eef285db8a1b7fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="derecho__type__definitions_8h.html#a307ecfdca0e28f653d9138dc0f676a77">node_id_t</a>, <a class="el" href="classtcp_1_1socket.html">tcp::socket</a>&gt; derecho::RestartLeaderState::waiting_join_sockets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="restart__state_8h_source.html#l00085">85</a> of file <a class="el" href="restart__state_8h_source.html">restart_state.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>derecho/<a class="el" href="restart__state_8h_source.html">restart_state.h</a></li>
<li>derecho/<a class="el" href="restart__state_8cpp_source.html">restart_state.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Dec 11 2018 17:01:47 for Derecho by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
